<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fun to Program -- GNOME | Goofing Osamu</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/en/">English</a></li>
      
      <li><a href="/jp/">Japanese</a></li>
      
      <li><a href="/index.xml">Subscribe</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Fun to Program &ndash; GNOME</span></h1>

<h3 class="date">Date:
2013/08/16 (initial publish),
2021/08/02 (last update)
</h3>
</div>

<main>


<table width="100%">
  <tbody>
  <tr>
  
  <td align="left" width="33%"><a href="/en/2013/08/15/fun2prog-build/">Previous Post</a></td>
  
  <td align="center" width="33%"><a href="/en/">Top</a></td>
  
  <td align="right" width="33%"><a href="/en/2013/08/17/fun2prog-gtkgui/">Next Post</a></td>
  
  </tr>
  </tbody>
</table>

<blockquote>
<p>This was originally written and created around 2013 and may require to be
updated. (2021)</p>
</blockquote>
<h2 id="gnome">GNOME</h2>
<p>The choice of the best GUI program practice is not simple since there are many
choices for GUI platforms, many outdated documentations, new features without
updated tutorials, and future uncertainties.</p>
<p>Despite people had very negative reaction to the GNOME3 due to its new default
user experience, I chose it as my GUI example platform for its fundamental
internal technical merits.  We can always customize the user experience part.</p>
<p>Here is my best effort to capture the recent GUI framework history for GNOME
and best sources for references.  (The latest stable is GNOME3.4 as of 2012 Summer.)</p>
<h3 id="gnome-history">GNOME history</h3>
<p><a href="http://en.wikipedia.org/wiki/GTK+">GTK+</a> is the GUI toolkit for
<a href="http://en.wikipedia.org/wiki/GNOME">GNOME</a> and is build on the top of C with
<a href="http://en.wikipedia.org/wiki/GLib">GLib</a> and
<a href="http://en.wikipedia.org/wiki/GObject">GObject</a>.  It requires many chores with
boiler plate macro definitions when used directly from a C program.  Its
modularity as a GUI toolkit has evolved roughly as follows.</p>
<ul>
<li>GTK+1.0 (1998): just separated from <a href="http://www.gimp.org/about/ancient_history.html">GIMP</a>.</li>
<li>GTK+1.2 (1999): reasonable shape for general applications.</li>
<li>GTK+2.0 (2002): for GNOME2 based on GLib, GObject, GIO, ATK, GDK, GdkPixbuff</li>
<li>GTK+3.0 (2011): for GNOME3 based on GLib, GObject, GIO, ATK, GDK, GdkPixbuff, <a href="http://en.wikipedia.org/wiki/Pango">Pango</a>
<ul>
<li>GTK+3.0 works with <a href="http://en.wikipedia.org/wiki/Cairo_(graphics)">Cairo</a>, <a href="http://en.wikipedia.org/wiki/Clutter_(toolkit)">Clutter</a>, and <a href="https://live.gnome.org/GObjectIntrospection/">GObject-introspection</a>, &hellip;</li>
</ul>
</li>
</ul>
<p><a href="http://en.wikipedia.org/wiki/GNOME">GNOME</a> has evolved significantly with its
<a href="http://en.wikipedia.org/wiki/Inter-process_communication%5Binter-process">http://en.wikipedia.org/wiki/Inter-process_communication[inter-process</a>
communication (IPC)] structure.  Its history is roughly as follows.</p>
<ul>
<li>GNOME1 (1999): <a href="http://en.wikipedia.org/wiki/CORBA">CORBA</a> (= <a href="http://en.wikipedia.org/wiki/Bonobo_(component_model)">Bonobo</a> + libIDL + ORBit) as IPC established.</li>
<li>GNOME2 (2002): Antialiased fonts, UNICODE support (internationalization), HIG compliance (accessibility), &hellip;
<ul>
<li>GNOME2 cycle: IPC migrated from CORBA to <a href="http://en.wikipedia.org/wiki/D-Bus">D-Bus</a>.</li>
</ul>
</li>
<li>GNOME3 (2011): D-Bus as IPC established. (<a href="http://developer.gnome.org/platform-overview/2.32/bonobo-corba.html.en">CORBA deprecated</a>)
<ul>
<li>GNOME3 cycle: <a href="https://live.gnome.org/GObjectIntrospection/">GObject-Introspection</a> is introduced.
<ul>
<li><a href="https://live.gnome.org/Vala">Vala</a> is becoming a popular choice to write applications for the native binary target instead of traditional and complicated C code with many boiler plate macro definitions.</li>
<li><a href="http://en.wikipedia.org/wiki/Python_(programming_language)">Python</a> with <a href="https://live.gnome.org/PyGObject">PyGObject</a> is a popular choice to write applications under the high level interpreter language with <a href="http://en.wikipedia.org/wiki/Just-in-time_compilation">JIT compilation</a>.</li>
<li><a href="http://en.wikipedia.org/wiki/JavaScript">Javascript</a> is becoming the choice for the embedded language of applications with the <a href="https://live.gnome.org/Gjs">Gjs</a> binding.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>GNOME3 applications are just plain GTK+3 applications.  There is no code bloat
by <a href="http://en.wikipedia.org/wiki/CORBA">CORBA</a> any more.</p>
<p><a href="https://live.gnome.org/GObjectIntrospection/Users%5BThe">https://live.gnome.org/GObjectIntrospection/Users[The</a> language binding system
based on GObject-Introspection] can provide:</p>
<ul>
<li>tighter binding including the memory management than the generic language binding systems such as <a href="http://www.swig.org/">SWIG</a> can, and</li>
<li>more consistent binding across different languages.</li>
</ul>
<p>GObject-Introspection xml data of each library can be found under the <code>/usr/share/gir-1.0</code> directory.</p>
<h2 id="glib-and-gobject">Glib and GObject</h2>
<p>Dynamic memory management using <code>malloc()</code> etc. is a big headache when coding
with C.:</p>
<ul>
<li><a href="http://www.gnu.org/software/libc/manual/html_node/Memory.html">Virtual Memory Allocation And Paging in The GNU C Library manual</a></li>
<li><a href="http://en.wikipedia.org/wiki/C_dynamic_memory_allocation">C dynamic memory allocation</a> (Wikipedia)</li>
<li><a href="http://en.wikipedia.org/wiki/Mmap">mmap</a> (Wikipedia)</li>
</ul>
<p>Such complication can be avoided using libraries such as Glib and GObject.</p>
<p>GLib is a general-purpose utility library, which provides many useful data
types, macros, type conversions, string utilities, file utilities, a mainloop
abstraction, utility data structures, and so on.</p>
<p><code>GString</code> offered in GLib is a data structure and associated methods offering
text buffers which grow automatically as text is added with the proper dynamic
memory management.</p>
<p>Source to convert to upper case.</p>

<pre><code>#include &lt;stdlib.h&gt;
#include &lt;glib.h&gt;
#include &lt;glib/gprintf.h&gt;

int main(int argc, char** argv) {
    GString a;
    if (argc == 2) {
    	a = *g_string_new(argv[1]);
    	g_printf(&#34;input  = &#39;%s&#39;\n&#34;, a.str);
    	a.str = g_ascii_strup(a.str, a.len);
    	g_printf(&#34;OUTPUT = &#39;%s&#39;\n&#34;, a.str);
    } else {
    	g_printf(&#34;%s put_word_to_be_printed_uppercase\n&#34;, argv[0]);
    }
    return EXIT_SUCCESS;
}

</code></pre>

<p>If we try to guess the library name and header location, it is not easy to get them right.</p>
<p>Manual failed compilation</p>

<pre><code>$ gcc -Wall -I/usr/include/glib-2.0 -lglib-2.0 -o upper-ng upper.c
In file included from /usr/include/glib-2.0/glib/galloca.h:34:0,
                 from /usr/include/glib-2.0/glib.h:32,
                 from upper.c:2:
/usr/include/glib-2.0/glib/gtypes.h:34:24: fatal error: glibconfig.h: No such fil...
 #include &lt;glibconfig.h&gt;
                        ^
compilation terminated.
</code></pre>

<p>Many modern libraries provide <code>*.pc</code> files in their development packages.  You
can use it with <code>pkg-config</code> to get proper compilation options for the glib
library.  Let&rsquo;s look for such thing for <code>glib</code>.</p>
<p>Search the development package of Glib</p>

<pre><code>$ apt-cache search &#39;libglib[0-9.-]*-dev&#39;
libglib2.0-dev - Development files for the GLib library
</code></pre>

<p>If the <code>libglib2.0-dev</code> package has not been installed, install it now.</p>
<p>Search the right <code>*.pc</code> file for Glib for use with <code>pkg-config</code>.</p>
<p>Search the right *.pc file for Glib</p>

<pre><code>$ grep -e &#34;^Description\|^Name\|^Requires&#34; \
   $(dpkg -L libglib2.0-dev|grep -e &#34;/pkgconfig/&#34;)| \
   sed -ne &#34;s/^.*\/pkgconfig\//.../p&#34;
...gmodule-export-2.0.pc:Name: GModule
...gmodule-export-2.0.pc:Description: Dynamic module loader for GLib
...gmodule-export-2.0.pc:Requires: glib-2.0
...glib-2.0.pc:Name: GLib
...glib-2.0.pc:Description: C Utility Library
...glib-2.0.pc:Requires.private: libpcre
...gio-unix-2.0.pc:Name: GIO unix specific APIs
...gio-unix-2.0.pc:Description: unix specific headers for glib I/O library
...gio-unix-2.0.pc:Requires: gobject-2.0,gio-2.0
...gmodule-no-export-2.0.pc:Name: GModule
...gmodule-no-export-2.0.pc:Description: Dynamic module loader for GLib
...gmodule-no-export-2.0.pc:Requires: glib-2.0
...gio-2.0.pc:Name: GIO
...gio-2.0.pc:Description: glib I/O library
...gio-2.0.pc:Requires: glib-2.0 gobject-2.0
...gio-2.0.pc:Requires.private: gmodule-no-export-2.0
...gthread-2.0.pc:Name: GThread
...gthread-2.0.pc:Description: Thread support for GLib
...gthread-2.0.pc:Requires: glib-2.0
...gmodule-2.0.pc:Name: GModule
...gmodule-2.0.pc:Description: Dynamic module loader for GLib
...gmodule-2.0.pc:Requires: glib-2.0
...gobject-2.0.pc:Name: GObject
...gobject-2.0.pc:Description: GLib Type, Object, Parameter and Signal Library
...gobject-2.0.pc:Requires: glib-2.0
</code></pre>

<p>The <code>glib-2.0.pc</code> file is the right file.</p>
<p>The glib-2.0.pc file found on the Debian wheezy system.</p>

<pre><code>prefix=/usr
exec_prefix=${prefix}
libdir=${prefix}/lib/x86_64-linux-gnu
includedir=${prefix}/include

glib_genmarshal=glib-genmarshal
gobject_query=gobject-query
glib_mkenums=glib-mkenums

Name: GLib
Description: C Utility Library
Version: 2.32.3
Requires.private: libpcre
Libs: -L${libdir} -lglib-2.0 
Libs.private: -pthread -lrt  -lpcre    
Cflags: -I${includedir}/glib-2.0 -I${libdir}/glib-2.0/include 
</code></pre>

<p>The right compile and link options used by Glib is given as follows.</p>
<p>Compile and link options used by Glib</p>

<pre><code>$ pkg-config --cflags --libs glib-2.0|fold -w72
-I/usr/include/glib-2.0 -I/usr/lib/x86_64-linux-gnu/glib-2.0/include  -l
glib-2.0
</code></pre>

<p>TIP: The Debian wheezy system on amd64 architecture has its <code>*.pc</code> file at
<code>/usr/lib/x86_64-linux-gnu/pkgconfig/glib-2.0.pc</code>.  Please note the additional
Multi-Arch specific <code>/x86_64-linux-gnu/</code> in its path.</p>
<p>By using this, the <code>upper.c</code> program can be compiled without error.</p>
<p>Compilation of upper.c with Glib</p>

<pre><code>$ gcc -Wall `pkg-config --cflags --libs glib-2.0` -o upper upper.c
</code></pre>

<p>By adding the <code>-v</code> option, the compilation details are exposed.</p>
<p>Compilation of upper.c with Glib with the -v option</p>

<pre><code>$ gcc -v -Wall `pkg-config --cflags --libs glib-2.0` -o upper-v upper.c
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.8/lto-wrapper
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion=&#39;Debian 4.8.1-9&#39; --with-bu...
Thread model: posix
gcc version 4.8.1 (Debian 4.8.1-9)
COLLECT_GCC_OPTIONS=&#39;-v&#39; &#39;-Wall&#39; &#39;-I&#39; &#39;/usr/include/glib-2.0&#39; &#39;-I&#39; &#39;/usr/lib/x86_...
 /usr/lib/gcc/x86_64-linux-gnu/4.8/cc1 -quiet -v -I /usr/include/glib-2.0 -I /usr...
GNU C (Debian 4.8.1-9) version 4.8.1 (x86_64-linux-gnu)
    compiled by GNU C version 4.8.1, GMP version 5.1.2, MPFR version 3.1.1-p2, MP...
GGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072
ignoring nonexistent directory &#34;/usr/local/include/x86_64-linux-gnu&#34;
ignoring nonexistent directory &#34;/usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../x86...
#include &#34;...&#34; search starts here:
#include &lt;...&gt; search starts here:
 /usr/include/glib-2.0
 /usr/lib/x86_64-linux-gnu/glib-2.0/include
 /usr/lib/gcc/x86_64-linux-gnu/4.8/include
 /usr/local/include
 /usr/lib/gcc/x86_64-linux-gnu/4.8/include-fixed
 /usr/include/x86_64-linux-gnu
 /usr/include
End of search list.
GNU C (Debian 4.8.1-9) version 4.8.1 (x86_64-linux-gnu)
    compiled by GNU C version 4.8.1, GMP version 5.1.2, MPFR version 3.1.1-p2, MP...
GGC heuristics: --param ggc-min-expand=100 --param ggc-min-heapsize=131072
Compiler executable checksum: 7de91109c57f16a4863bda169a999c04
COLLECT_GCC_OPTIONS=&#39;-v&#39; &#39;-Wall&#39; &#39;-I&#39; &#39;/usr/include/glib-2.0&#39; &#39;-I&#39; &#39;/usr/lib/x86_...
 as -v -I /usr/include/glib-2.0 -I /usr/lib/x86_64-linux-gnu/glib-2.0/include --6...
GNU assembler version 2.23.52 (x86_64-linux-gnu) using BFD version (GNU Binutils ...
COMPILER_PATH=/usr/lib/gcc/x86_64-linux-gnu/4.8/:/usr/lib/gcc/x86_64-linux-gnu/4....
LIBRARY_PATH=/usr/lib/gcc/x86_64-linux-gnu/4.8/:/usr/lib/gcc/x86_64-linux-gnu/4.8...
COLLECT_GCC_OPTIONS=&#39;-v&#39; &#39;-Wall&#39; &#39;-I&#39; &#39;/usr/include/glib-2.0&#39; &#39;-I&#39; &#39;/usr/lib/x86_...
 /usr/lib/gcc/x86_64-linux-gnu/4.8/collect2 --sysroot=/ --build-id --eh-frame-hdr...
</code></pre>

<p>When reading <a href="http://developer.gnome.org/glib/stable/">GLib Reference Manual</a>
(via web or <code>devhelp</code>) and the source of GLib, please note that GLib is written
using its own fundamental type system.</p>
<h3 id="fundamental-fixed-size-data-types">Fundamental fixed size data types</h3>
<p>GLib uses its own fixed size data types.</p>
<ul>
<li>Types prefixed by &ldquo;g&rdquo; which are equivalent of ones in standard C
<ul>
<li><code>gchar</code> <code>gint</code> <code>gshort</code> <code>glong</code> <code>gfloat</code> <code>gdouble</code></li>
</ul>
</li>
<li>Unsined types prefixed by &ldquo;gu&rdquo; which are equivalent of unsined ones in standard C
<ul>
<li><code>guchar</code> <code>guint</code> <code>gushort</code> <code>gulong</code></li>
</ul>
</li>
<li>Integer types with platform independent specified bit size
<ul>
<li><code>gint8</code> <code>guint8</code> <code>gint16</code> <code>guint16</code> <code>gint32</code> <code>guint32</code> <code>gint64</code> <code>guint64</code></li>
</ul>
</li>
<li>Untyped pointer alias
<ul>
<li><code>gpointer</code>: C99 type <code>void*</code></li>
<li><code>gconstpointer</code>: C99 type <code>const void*</code></li>
</ul>
</li>
<li>New types which are not part of standard C
<ul>
<li><code>gboolean</code>: value=TRUE or FALSE</li>
<li><code>gsize</code>: C99 unsigned integer type <code>size_t</code> (usually 64bit or 32bit)</li>
<li><code>gssize</code>: C99 signed integer type <code>ssize_t</code> (usually 64bit or 32bit)</li>
<li><code>goffset</code>: C99 type <code>off64_t</code></li>
<li><code>gintptr</code>: C99 type <code>intptr_t</code></li>
<li><code>guintptr</code>: C99 type <code>uintptr_t</code></li>
</ul>
</li>
</ul>
<h3 id="fundamental-variable-size-data-types">Fundamental variable size data types</h3>
<p>Glib offers its own variable size data types with associated routines such as
memory allocation for many utility data structures such as <code>GString</code>.</p>
<ul>
<li><code>GList</code>: Doubly-Linked Lists &ndash; linked lists that can be iterated over in both directions</li>
<li><code>GSList</code>: Singly-Linked Lists &ndash; linked lists that can be iterated in one direction</li>
<li><code>GQueue</code>: Double-ended Queues &ndash; double-ended queue data structure</li>
<li><code>GSequence</code>: Sequences &ndash; scalable lists</li>
<li><code>GTrashStack</code>: Trash Stacks &ndash; maintain a stack of unused allocated memory chunks</li>
<li><code>GHashTable</code>: Hash Tables &ndash; associations between keys and values so that given a key the value can be found quickly</li>
<li><code>GString</code>: Strings &ndash; text buffers which grow automatically as text is added</li>
<li><code>GStringChunk</code>: String Chunks &ndash; efficient storage of groups of strings</li>
<li><code>GArray</code>: Arrays &ndash; arrays of arbitrary elements which grow automatically as elements are added</li>
<li><code>GPtrArray</code>: Pointer Arrays &ndash; arrays of pointers to any type of data, which grow automatically as new elements are added</li>
<li><code>GByteArray</code>: Byte Arrays &ndash; arrays of bytes</li>
<li><code>GTree</code>: Balanced Binary Trees &ndash; a sorted collection of key/value pairs optimized for searching and traversing in order</li>
<li><code>GNode</code>: N-ary Trees &ndash; trees of data with any number of branches</li>
<li><code>GQuark</code>: Quarks &ndash; a 2-way association between a string and a unique integer identifier</li>
<li><code>GData</code>: Keyed Data Lists &ndash; lists of data elements which are accessible by a string or GQuark identifier
<ul>
<li><code>Datasets</code> &ndash; associate groups of data elements with particular memory locations</li>
</ul>
</li>
<li><code>GVariantType</code>: GVariantType &ndash; introduction to the GVariant type system</li>
<li><code>GVariant</code>: GVariant &ndash; strongly typed value datatype
<ul>
<li><code>GVariant Format Strings</code> &ndash; varargs conversion of GVariants</li>
<li><code>GVariant Text Format</code> &ndash; textual representation of GVariants</li>
</ul>
</li>
</ul>
<h2 id="gobject">GObject</h2>
<p>GObject provides a generic type system to register arbitrary single-inherited
flat and deep derived types as well as interfaces for structured types in C on
top of GLib fundamental data types.</p>
<p>C with GLib and GObject offers an alternative to C++ with its Standard library
although it requires many chores with
<a href="http://developer.gnome.org/gobject/stable/gtype-conventions.html%5Bboiler">http://developer.gnome.org/gobject/stable/gtype-conventions.html[boiler</a> plate
macro definitions].</p>
<p>The GTK+ GUI toolkit is build on the top of C with GLib and GObject.  If you
wish to simplify this coding process, please think about Vala.  For more see
the following section on this document and the followings:</p>
<p>See more at:</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/GLib">GLib (wikipedia)</a></li>
<li><a href="http://en.wikipedia.org/wiki/GObject">GObject (wikipedia)</a></li>
<li><a href="http://developer.gnome.org/glib/stable/">GLib (upstream doc)</a>, or via <code>devhelp</code></li>
<li><a href="http://developer.gnome.org/gobject/stable/">GObject (upstream doc)</a>, or via <code>devhelp</code></li>
<li><a href="http://www.ibm.com/developerworks/linux/tutorials/l-glib/">Manage C data using the GLib collections</a> by Tom Copeland. (IBM DW, Date: 28 Jun 2005)</li>
<li><a href="http://lore.ua.ac.be/Publications/summary/Hendrickx2004.php">Glib-C: C as an alternative Object Oriented Environment</a> (PDF) by  Steven Hendrickx. (2004)</li>
</ul>
<h2 id="gtk3">GTK+3</h2>
<p>Although we are at GTK+3, we have many older documentations for GTK+2 but not enough ones for GTK+3.</p>
<p>Those older documentations for GTK+2 contain useful contents as long as they are used carefully.</p>
<p>For pure C programs, migrating from GTK+2 to GTK3+ is basically as easy as
changing from &ldquo;gtk+-2.0&rdquo; to &ldquo;gtk+-3.0&rdquo; in <code>pkg-config</code> argument.  In case of
troubles such as missing <code>GtkObject</code> and many missing GDK API issues, see
<a href="http://developer.gnome.org/gtk3/3.0/migrating.html%5BGTK+">http://developer.gnome.org/gtk3/3.0/migrating.html[GTK+</a> 3 Reference Manual:
Part V. Migrating from Previous Versions of GTK+].</p>
<p>Here are basic references:</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/GTK+">GTK+ (wikipedia)</a></li>
<li><a href="http://www.gtk.org/documentation.php">GTK+ (upstream doc)</a>, or via <code>devhelp</code></li>
<li><a href="http://developer.gnome.org/gtk3/stable/index.html">GTK+ 3 Reference Manual</a></li>
</ul>
<h2 id="glade">Glade</h2>
<p><a href="http://en.wikipedia.org/wiki/Glade_Interface_Designer">Glade</a> is the UI design
tool for GTK+.  Its output is an XML file and can be loaded directly to GTK+.
If you wish to simplify the GUI coding process with many UI widgets under any
language, please think about using Glade.</p>
<p>See:</p>
<ul>
<li><a href="https://live.gnome.org/Glade/Tutorials">Glade Tutorials</a> (pointers)
<ul>
<li><a href="http://blog.borovsak.si/">Tips and tutorials related to GTK+ toolkit</a> (2009-2010)</li>
<li><a href="http://www.micahcarrick.com/gtk-glade-tutorial-part-1.html">GTK+ and Glade3 GUI Programming Tutorial</a> (2007)</li>
<li><a href="http://scentric.net/tutorial/treeview-tutorial.html">GTK+ 2.0 Tree View Tutorial</a> (2005)</li>
<li><a href="http://virtualex.linuxoid.net/2009/08/18/glade-catalog-tutorial/">Glade Catalog Tutorial</a> (2009)</li>
</ul>
</li>
<li><a href="http://developer.gnome.org/gladeui/3.6/">Glade User Interface Designer Reference Manual</a> (API for Glade 3.6)</li>
<li><a href="http://www.youtube.com/playlist?list=PL70617645D7DC1FD1&amp;feature=plcp">Tutorial: A GUI application using Python &amp; gtk.Builder</a> (2009, Video)
<ul>
<li>Learn how to use Glade GUI from video.</li>
<li>Disregard details of Python code since it is based on gtk.Builder from PyGTK for GTK+2 and outdated.</li>
</ul>
</li>
</ul>
<h2 id="pygobject">PyGObject</h2>
<p>Python bindings of GTK+ has evolved.</p>
<ul>
<li>PyGTK for GTK+2: (deprecated))
<ul>
<li>starting code with &ldquo;<code>import pygtk</code>&rdquo; (newer), or &ldquo;<code>import gtk</code>&rdquo; (older)</li>
</ul>
</li>
<li>PyGObject for GTK+3: (recommended)
<ul>
<li>starting code with &ldquo;<code>from gi.repository import Gtk</code>&rdquo; (current)</li>
</ul>
</li>
</ul>
<p>So we focus on the latest PyGObject for GTK+3 and recommend you to start with:</p>
<ul>
<li><a href="http://python-gtk-3-tutorial.readthedocs.org/en/latest/">The Python GTK+ 3 Tutorial</a> (2012)</li>
</ul>
<p>Unfortunately, as of 2012 on Debian wheezy, we can not find good reference
documentations of GTK+3 and its related libraries for Python.</p>
<p>We can create a usable reference documentation of GTK+3 and related libraries
by yourself using the <code>g-ir-doc-tool</code> command from the gobject-introspection
package as explained in
<a href="https://live.gnome.org/GObjectIntrospection/Doctools%5BGObject">https://live.gnome.org/GObjectIntrospection/Doctools[GObject</a> Introspection
Doctools].</p>
<pre><code>$ g-ir-doc-tool --language Python -o ./output_dir /usr/share/gir-1.0/Gtk-3.0.gir
$ yelp ./output_dir/index.page
</code></pre><p>Despite the efforts to make GTK+3 PyGObject as compatible to the older GTK+2
PyGTK as possible, the differences are still huge.  See
<a href="http://pfrields.fedorapeople.org/presentations/OhioLF2011/PyGObject.pdf%5BGraduating">http://pfrields.fedorapeople.org/presentations/OhioLF2011/PyGObject.pdf[Graduating</a>
to GUI (PDF)].</p>
<p>Please note older PyGTK for GTK+2 are still used widely as of now.  The new
GTK+3 Python codes using PyGObject such as <code>accerciser</code>, <code>caribou-preferences</code>,
<code>gdebi-gtk</code>, <code>gnome-shell-timer-config</code>, <code>software-center</code>, and
<code>software-properties-gtk</code> provide us with good examples.</p>
<h2 id="vala">Vala</h2>
<p>Vala is a programming language specifically designed to ease the traditional C
coding process for GNOME3. The Vala compiler generates C codes using the object system of GNOME with GLib, GObject, etc.  Vala offers capabilities such as:</p>
<ul>
<li>access to the modern object oriented language features such as <code>class</code>,</li>
<li>access to the automatic memory management system based on the reference counting,</li>
<li>access to all C libraries, and</li>
<li>generation of native binaries with the C API.</li>
</ul>
<p>Writing codes for GNOME with the plain C is very tedious and error prone
process. But Writing codes for GNOME in Vala is very simple and straigtfrward
process just like writing codes under high-level languages such as Python,
Java, or MONO/C#.</p>
<p>TIP: Vala does not free you from thinking in C.  Think Vala as a nice pre-processor.</p>
<p>Let&rsquo;s start here:</p>
<ul>
<li><a href="https://live.gnome.org/Vala/Tutorial">Vala Tutorial</a></li>
<li><a href="http://valadoc.org/#!wiki=index">Valadoc Online API Documentation</a></li>
</ul>
<p>In Vala, GLib and GObject objects are available as default.  Almost any
libraries written in C can be accessed from Vala by declaring <code>using ...;</code> at
the top using Vala bindings defined as VAPI files located in the <code>/usr/share/vala*/vapi/</code> directory.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><a href="https://live.gnome.org/Vala/Bindings">Vala binding to GObject-based libraries</a> are generated automatically as:</p>
<ul>
<li>generating GObject Introspection GIR file (stored in the <code>/usr/share/gir-1.0</code> directory)</li>
<li>generation the VAPI binding from the GIR file with <code>vapigen</code></li>
<li>tweaking the binding generation with metadata and custom code</li>
<li>their VAPI files contain &ldquo;generated by vapigen&rdquo; in it.</li>
</ul>
<p><a href="https://live.gnome.org/Vala/ExternalBindings%5BVala">https://live.gnome.org/Vala/ExternalBindings[Vala</a> binding to non-GObject-based
C libraries] are manually generated and their VAPI files do not contain
&ldquo;generated by vapigen&rdquo; in it.</p>
<p>The C API is always available in the pertinent manpage, info page, or
documentations accessed via <code>devhelp</code>.  But Vala API is a bit difficult to get
at this moment and explained as below.</p>
<p>C API names of many libraries are mapped to Vala ones with the similar naming
convention as GLib naming convention as:</p>
<ul>
<li>C API: <code>g_topic_foobar()</code></li>
<li>Vala API: <code>GLib.Topic.foobar()</code></li>
</ul>
<p>The exact mapping from C API names to Vala ones is defined in <code>*.vapi</code> (Vala
API) files found in <code>/usr/share/vala*/vapi/</code>.  For example, on Debian wheezy:</p>
<ul>
<li>Glib: <code>/usr/share/vala-0.16/vapi/glib-2.0.vapi</code></li>
<li>GObject: <code>/usr/share/vala-0.16/vapi/gobject-2.0.vapi</code></li>
<li>GTK+: <code>/usr/share/vala-0.16/vapi/gtk+-3.0.vapi</code></li>
<li>POSIX: <code>/usr/share/vala-0.16/vapi/posix.vapi</code> (libc/libm library)</li>
<li>CURSES: <code>/usr/share/vala-0.16/vapi/curses.vapi</code> (curses library)</li>
</ul>
<p>These <code>*.vapi</code> (Vala API) files are written in Vala language with extensive use
of the <a href="https://live.gnome.org/Vala/Manual/Attributes">attributes</a> such as
<code>CCode</code>.  Here are some cliches used in <code>*.vapi</code> files:</p>
<ul>
<li><code>[CCode (cprefix ...)]</code>
<ul>
<li>This is primarily used for namespaces. While when left to its
own devices valac will simply concatenate the parent names to
generate C type names, setting the <code>cprefix</code> allows you to
override this. For instance, assuming you have a class
<code>Foo.Bar.Baz</code>, setting a cprefix of &ldquo;<code>Fubar</code>&rdquo; on a your <code>Bar</code>
namespace will result in a C name of &ldquo;<code>FubarBaz</code>&rdquo; for the <code>Baz</code>
class.</li>
</ul>
</li>
<li><code>[CCode (lower_case_cprefix ...)]</code>
<ul>
<li>This overrides everything up to the start of
the method name. For instance, a method named <code>Foo.Bar.baz</code> would
normally result in a C name of <code>foo_bar_baz</code>. However, if you set
the <code>lower_case_cprefix</code> of the <code>bar</code> class to be &ldquo;<code>fb_</code>&rdquo;, the
resulting C name would be &ldquo;<code>fb_baz</code>&rdquo;.</li>
</ul>
</li>
<li><code>[CCode (cname ...)]</code>
<ul>
<li>This sets the C name to exactly what you specify here. For
instance, if you set the <code>cname</code> of a <code>Foo.Bar.baz</code> method to
&ldquo;<code>bacon</code>&rdquo;, the name of the <code>Foo.Bar.baz</code> function in C will be
&ldquo;<code>bacon</code>&rdquo;.</li>
</ul>
</li>
</ul>
<p>Here are some reminders for errors when using Gtk.Builder with Vala.</p>
<ul>
<li>
<p>Forgetting to use <code>[CCode (instance_pos = -1)]</code> when using instance
methods instead of static methods as handlers</p>
</li>
<li>
<p>Forgetting to mangle the handler method names in Glade, e.g. from
<code>FooBar.my_handler</code> to <code>foo_bar_my_handler</code></p>
</li>
<li>
<p>Not using the right signature for the handler. One missing parameter
or one parameter too much will result in a segmentation fault.</p>
</li>
</ul>
<p>Let me explain the last case a bit more.  If the signal signature is</p>
<pre><code>public class Area : Object {
    public signal void clicked (int x, int y);
}
</code></pre><p>then the handler method must have <em>exactly</em> these parameters in order
to work with Gtk.Builder&rsquo;s auto-connect:</p>
<pre><code>
public void on_clicked (Area source, int x, int y) { }
</code></pre><p>Vala can&rsquo;t recognize this mistake, because auto-connection happens at
runtime an it doesn&rsquo;t know at compile-time which method will be connected
to which signal.</p>
<p>See also:</p>
<ul>
<li><a href="https://live.gnome.org/Vala">Vala - Compiler for the GObject type system</a> &ndash; Homepage</li>
<li><a href="https://live.gnome.org/Vala/Documentation">Vala - Documentation</a> &ndash; Sample Code</li>
<li><a href="https://live.gnome.org/Vala/Manual">Vala - Manual (Draft)</a></li>
<li><a href="https://live.gnome.org/Vala/Hacking">Hackers' Guide to Vala</a></li>
<li>C API documentation found in <code>devhelp</code> or for <a href="http://developer.gnome.org/glib/unstable/">GLib</a>, <a href="http://developer.gnome.org/gobject/unstable/">GObject</a>, and <a href="http://www.gtk.org/documentation.php">GTK+</a>.</li>
</ul>
<h2 id="javascript">JavaScript</h2>
<p><a href="http://en.wikipedia.org/wiki/JavaScript">JavaScript</a> programming language is
selected to be the embedded language of
<a href="http://en.wikipedia.org/wiki/GNOME_Shell">GNOME Shell</a> as
<a href="https://gitlab.gnome.org/GNOME/gjs">Gjs</a>.  See:</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/JavaScript">JavaScript</a> (Mozilla)</li>
<li><a href="https://live.gnome.org/JavaScript">JavaScript</a> (GNOME)</li>
<li><a href="https://live.gnome.org/GnomeShell">GNOME Shell</a></li>
<li><a href="https://live.gnome.org/GnomeShell/Technology">GNOME Shell: Technology</a></li>
<li><a href="https://live.gnome.org/GnomeShell/Extensions">GNOME Shell: Extensions</a></li>
<li><a href="https://live.gnome.org/GnomeShell/Extensions/StepByStepTutorial">GNOME Shell: Step by step tutorial to create extensions</a></li>
</ul>
<p>I am not going into details now.</p>
<!-- raw HTML omitted -->


<table width="100%">
  <tbody>
  <tr>
  
  <td align="left" width="33%"><a href="/en/2013/08/15/fun2prog-build/">Previous Post</a></td>
  
  <td align="center" width="33%"><a href="/en/">Top</a></td>
  
  <td align="right" width="33%"><a href="/en/2013/08/17/fun2prog-gtkgui/">Next Post</a></td>
  
  </tr>
  </tbody>
</table>

</main>

  <footer>
  
  
  <hr/>
  © 2019-2021 <a href="https://github.com/osamuaoki">Osamu Aoki</a>
  
  </footer>
  </body>
</html>

