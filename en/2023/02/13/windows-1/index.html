<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Windows from Linux (1) | Goofing Osamu</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/en/">English</a></li>
      
      <li><a href="/jp/">Japanese</a></li>
      
      <li><a href="/index.xml">Subscribe</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Windows from Linux (1)</span></h1>

<h3 class="date">Date:
2023/02/13 (initial publish),
2023/05/14 (last update)
</h3>
</div>

<main>


<table width="100%">
  <tbody>
  <tr>
  
  <td align="left" width="33%"><a href="/en/2023/02/13/svt1313-1/">Previous Post</a></td>
  
  <td align="center" width="33%"><a href="/en/">Top</a></td>
  
  <td align="right" width="33%"><a href="/en/2023/02/20/systemd-nspawn-1/">Next Post</a></td>
  
  </tr>
  </tbody>
</table>

<h2>TOC</h2>

<nav id="TableOfContents">
  <ul>
    <li><a href="#windows-from-linux">Windows from Linux</a></li>
    <li><a href="#windows-installation-from-linux">Windows installation from Linux</a>
      <ul>
        <li><a href="#information-on-windows-installation">Information on Windows installation</a></li>
        <li><a href="#available-gnu--linux-tools-for-windows-installation">Available GNU + Linux tools for Windows installation</a></li>
        <li><a href="#how-to-create-a-usb-flash-drive-to-install-windows">How to create a USB flash drive to install Windows</a></li>
        <li><a href="#related-articles-and-resources-for-windows-installation">Related articles and resources for Windows installation</a></li>
      </ul>
    </li>
  </ul>
</nav>

<h2 id="windows-from-linux">Windows from Linux</h2>
<p>There are few ways to access Windows resources.</p>
<ul>
<li>Install Microsoft Windows into a disk partition and make it dual-bootable.</li>
<li>Use <a href="https://www.microsoft.com/ja-jp/microsoft-365">Windows 365</a> to <a href="https://www.makeuseof.com/tag/install-use-microsoft-office-linux/">use it from a web browser</a></li>
<li><a href="https://ruados.github.io/articles/2021-05/office365-wine">Run Office 365 application in Wine</a></li>
<li><a href="https://itsfoss.com/use-microsoft-office-linux/#using-crossover">Other tips</a></li>
</ul>
<h2 id="windows-installation-from-linux">Windows installation from Linux</h2>
<p>Creation of Windows USB installation media on GNU + Linux platform can be
automated by using
<a href="https://github.com/WoeUSB/WoeUSB">https://github.com/WoeUSB/WoeUSB</a>.</p>
<p>Let&rsquo;s see what is involved behind &ldquo;Windows from Linux&rdquo; as below.</p>
<h3 id="information-on-windows-installation">Information on Windows installation</h3>
<p>The official Microsoft documentation gives us good entry points:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/install-windows-from-a-usb-flash-drive">Install Windows from a USB Flash Drive</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/windows-setup-installing-using-the-mbr-or-gpt-partition-style?source=recommendations&amp;view=windows-11">Windows Setup: Installing using the MBR or GPT partition style</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/bringup/switch-from-legacy-mbr-disk-to-gpt-disk-with-windows-10">Switch from legacy MBR disk to GPT disk with Windows 10</a></li>
<li><a href="https://learn.microsoft.com/en-US/windows-server-essentials/install/create-a-bootable-usb-flash-drive">Create a Bootable USB Flash Drive</a></li>
<li><a href="https://www.microsoft.com/en-US/software-download/windows10ISO">Windows 10 ISO image download page</a>
<ul>
<li><a href="https://www.microsoft.com/en-us/windows/compare-windows-10-home-vs-pro">Compare Windows 10 Home vs. Pro</a></li>
<li><a href="https://answers.microsoft.com/en-us/windows/forum/all/difference-between-windows-10-windows-10n-windows/9cfde2eb-011b-4227-91f5-00168a74525f">Difference BETWEEN Windows 10 ,Windows 10N, Windows 10KN, &hellip;</a></li>
</ul>
</li>
<li><a href="https://www.microsoft.com/en-US/software-download/windows11">Windows 11 ISO image download page</a></li>
</ul>
<p>You should probably get your localized <strong>Windows 10 pro</strong> image for <strong>Windows
10</strong> (Not Windows 10N nor Windows 10KN.  These are for people living in Europe
or South Korea).</p>
<h3 id="available-gnu--linux-tools-for-windows-installation">Available GNU + Linux tools for Windows installation</h3>
<p>Useful tools on Debian to manipulate disk data:</p>
<ul>
<li><a href="https://packages.debian.org/sid/gdisk">gdisk</a> &ndash; GPT fdisk text-mode partitioning tool (with in place conversion of MBR to GPT)</li>
<li><a href="https://packages.debian.org/sid/parted">parted</a> &ndash; disk partition manipulator (CLI)</li>
<li><a href="https://packages.debian.org/sid/gparted">gparted</a> &ndash; GNOME partition editor (GUI)</li>
<li><a href="https://packages.debian.org/sid/msb">msb</a> &ndash; Master Boot Record for IBM-PC compatible computers</li>
<li><a href="https://packages.debian.org/unstable/wimtools">wimtools</a> &ndash; Tools for manipulating Windows Imaging files</li>
</ul>
<h3 id="how-to-create-a-usb-flash-drive-to-install-windows">How to create a USB flash drive to install Windows</h3>
<p>The recent Windows ISO image contains <code>sources/install.wim</code> which is about 5GiB
and exceeds 4 GiB filesize limit on FAT32 frequently used on the USB flash
disk.</p>
<p>Although the disk image is called &ldquo;ISO file&rdquo;, this is not formatted in ISO9660
but actually formatted in UDF format which doesn&rsquo;t suffer from 4GB file size
limitation. This &ldquo;ISO file&rdquo; isn&rsquo;t a hybrid file system overlaying harddisk file
system so you can&rsquo;t use this ISO image with simple &ldquo;<code>dd if= ...</code>&rdquo; to make
bootable USB key (I know many of us Linux user feel like doing it.)</p>
<p>So we need to cope with this complication.</p>
<p>The following can make a USB flash drive to install Windows via UEFI on GPT
disk.</p>
<ul>
<li>Download Windows 10 install media as ISO image</li>
<li>Mount ISO image and make its contents accessible</li>
<li>Format USB flash drive with FAT32 filesystem on the first partition of GPT
disk.</li>
<li>Copy everything in the ISO image to USB flash drive
<ul>
<li>split <code>sources/install.wim</code> using <code>wimsplit</code> (equivalently
<code>wimlib-imagex split</code>) into parts to cope with the 4GiB filesize limit</li>
</ul>
</li>
</ul>
<p>If the <code>install.wim</code> is slightly larger than 4GB limit, you may use file
compression with <code>wimlib-imagex optimize install.wim --solid</code> to <a href="https://tqdev.com/2019-cannot-copy-windows-10-install-wim">make it fit in
4GB limit</a> and do
without using <code>split</code>, instead.</p>
<p>If the UEFI available on your system also supports NTFS or the
<a href="https://github.com/pbatard/uefi-ntfs">UEFI:NTFS</a> is used along with the UEFI,
you can format USB flash drive with NTFS filesystem instead and boot Windows by
copying the original <code>sources/install.wim</code> into this NTFS filesystem without
splitting it.</p>
<p>You may also make this USB flash drive as Legacy/UEFI hybrid boot disk using
the standard tricks.</p>
<h3 id="related-articles-and-resources-for-windows-installation">Related articles and resources for Windows installation</h3>
<ul>
<li><a href="https://blog.be-dama.com/2021/08/03/linux_winboot_usb/">Linux環境でWindows10のインストールUSBメモリを作成</a></li>
<li><a href="http://reboot.pro/topic/20468-create-a-windows-system-from-scratch-using-linux/">Create a windows system from scratch using Linux</a></li>
<li><a href="https://github.com/pbatard/rufus">Rufus &ndash; The Reliable USB Formatting Utility</a></li>
<li><a href="https://github.com/pbatard/uefi-ntfs">UEFI:NTFS - Boot NTFS or exFAT partitions from UEFI</a></li>
<li><a href="https://wiki.debian.org/UEFI">Debian wiki: UEFI</a></li>
</ul>
<!-- raw HTML omitted -->


<table width="100%">
  <tbody>
  <tr>
  
  <td align="left" width="33%"><a href="/en/2023/02/13/svt1313-1/">Previous Post</a></td>
  
  <td align="center" width="33%"><a href="/en/">Top</a></td>
  
  <td align="right" width="33%"><a href="/en/2023/02/20/systemd-nspawn-1/">Next Post</a></td>
  
  </tr>
  </tbody>
</table>

</main>

  <footer>
  
  
  <hr/>
  © 2013-2021 <a href="https://github.com/osamuaoki">Osamu Aoki</a>
  
  </footer>
  </body>
</html>

