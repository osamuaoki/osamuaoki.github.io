<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Personal DEB package repository | Goofing Osamu</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/en/">English</a></li>
      
      <li><a href="/jp/">Japanese</a></li>
      
      <li><a href="/index.xml">Subscribe</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Personal DEB package repository</span></h1>

<h3 class="date">Date:
2022/08/20 (initial publish),
2023/04/29 (last update)
</h3>
</div>

<main>


<table width="100%">
  <tbody>
  <tr>
  
  <td align="left" width="33%"><a href="/en/2022/07/29/vim-learn-5/">Previous Post</a></td>
  
  <td align="center" width="33%"><a href="/en/">Top</a></td>
  
  <td align="right" width="33%"><a href="/en/2023/02/01/vim-learn-6/">Next Post</a></td>
  
  </tr>
  </tbody>
</table>

<h2>TOC</h2>

<nav id="TableOfContents">
  <ul>
    <li><a href="#personal-deb-package-repo-on-github-page">Personal DEB-package repo on github page</a>
      <ul>
        <li><a href="#gnu-pg">GNU PG</a></li>
        <li><a href="#setting-up-secure-apt-cliant">Setting up secure-APT cliant</a></li>
        <li><a href="#setting-up-package-repository">Setting up package repository</a></li>
      </ul>
    </li>
    <li><a href="#adding-personal-binary-package-repository">Adding personal binary package repository</a></li>
    <li><a href="#personal-packages">Personal packages</a></li>
  </ul>
</nav>

<h2 id="personal-deb-package-repo-on-github-page">Personal DEB-package repo on github page</h2>
<p>Since Githubs offer nice web site hosting service, I decided to host my private
build results there at <a href="http://osamuaoki.github.io/debian">http://osamuaoki.github.io/debian</a>.</p>
<p>This let me skip running the web server as described in <a href="/en/2021/04/09/dev-02/">Local private package
repo</a>.</p>
<p>Since <a href="http://salsa.debian.org">Debian Salsa</a> runs Gitlab and Gitlab also
offers equivalent web site hosting service, one should be able to do the same
there.  But considering tight resource constaints there, it may not be a good
idea to do this on Salsa.</p>
<p>Let me go step-by-step.</p>
<h3 id="gnu-pg">GNU PG</h3>
<p>Since I will use sub-key for this purpose, let me check:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ gpg --list-secret-keys  --with-subkey-fingerprint
</span></span><span style="display:flex;"><span>pub   rsa4096 2010-09-23 <span style="color:#f92672">[</span>SC<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>      3133724D6207881579E95D621E1356881DD8D791
</span></span><span style="display:flex;"><span>uid           <span style="color:#f92672">[</span>ultimate<span style="color:#f92672">]</span> Osamu Aoki &lt;osamu@debian.org&gt;
</span></span><span style="display:flex;"><span>sub   rsa4096 2010-09-23 <span style="color:#f92672">[</span>E<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>      FDCAD8AB29E281A0E004B510A04CBCEEF08BEFAD
</span></span></code></pre></div><p>Now we know hash for subkey.</p>
<p>For getting a compact public key:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ gpg --export -a --export-options export-minimal <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  3133724D6207881579E95D621E1356881DD8D791
</span></span><span style="display:flex;"><span>-----BEGIN PGP PUBLIC KEY BLOCK-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mQINBEya74YBEADDpLTJCmyS97kZ6JvlpUEoSoVbqEkyQVfrV7C7VqlBGWO0bTKI
</span></span><span style="display:flex;"><span>... snip ...
</span></span><span style="display:flex;"><span>-----END PGP PUBLIC KEY BLOCK-----
</span></span></code></pre></div><h3 id="setting-up-secure-apt-cliant">Setting up secure-APT cliant</h3>
<p>Let&rsquo;s use DEB822-STYLE FORMAT as explained in sources.list(5) and avoid using
deprecated apt-key mechanism.</p>
<p>I add <code>/etc/apt/sources.d/osamuaoki.sources</code> to the client as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ cat &gt;/etc/apt/sources.list.d/osamuaoki.sources  &lt;&lt;<span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span>Types: deb
</span></span><span style="display:flex;"><span>URIs: http://osamuaoki.github.io/debian/
</span></span><span style="display:flex;"><span>Suites: sid
</span></span><span style="display:flex;"><span>Components: main
</span></span><span style="display:flex;"><span>Signed-By:
</span></span><span style="display:flex;"><span> -----BEGIN PGP PUBLIC KEY BLOCK-----
</span></span><span style="display:flex;"><span> .
</span></span><span style="display:flex;"><span> mQINBEya74YBEADDpLTJCmyS97kZ6JvlpUEoSoVbqEkyQVfrV7C7VqlBGWO0bTKI
</span></span><span style="display:flex;"><span> z0QAOkzF47HIDTez+ISLRd84Dyh/BPpSTF2CP3HnLo21UxotvQFeVVs87EKTgrM5
</span></span><span style="display:flex;"><span> MsRgmEU4o28be0Uz0ix0U5ahaOqX6TI1+faZ8Bn2Q9MnhYoSaS0DyRrEAIU0xrSk
</span></span><span style="display:flex;"><span> VDrN3GrjUYli2GwF/GgKCKT92rxPvcaJIbtMqNWkm9QJVqyTLNw/kY1ywU5weehE
</span></span><span style="display:flex;"><span> tIK0IU2ib5dakYubUfdCv54UXAB30sryMpgbi60ELEtEG1t6icKBOta+kCHkDggl
</span></span><span style="display:flex;"><span> Ts9YIAOMQvRy1qwiySuv1P+4AOSoC7yS/WlGBoGOhThSnGcdjoXXGixmkeSw3MO5
</span></span><span style="display:flex;"><span> F/2e3vd7BWDDygyxJldtf8p6OmD6bj7FLoPB97Qvilpt2JQ27Sn9zVOC4/wCKaqx
</span></span><span style="display:flex;"><span> 628GXsKx4gyoieSCKxHJuGTuD7nyAnqn/E04IyhJ5TAjai39x+ZUwWnT84dSOnEm
</span></span><span style="display:flex;"><span> 0+3lORr9Iwkrbrom5BFZ9vrgEQ1Dp52v5anfjlPPiPdUMF/66H9nFrhjS26LLodA
</span></span><span style="display:flex;"><span> WUEWAoc4u2vjAOD2LGjCs1XKdVMgFci2rVLSVYlj2aWjU3dPUvqvGo0IReiJx9RY
</span></span><span style="display:flex;"><span> MEBZnc9CHEdWFZjVUFFKc/pjrgwIcq6LDRIPdd2n8bYy0y8TxFwyax9bPQARAQAB
</span></span><span style="display:flex;"><span> tB1Pc2FtdSBBb2tpIDxvc2FtdUBkZWJpYW4ub3JnPokCOAQTAQIAIgUCTJrvhgIb
</span></span><span style="display:flex;"><span> AwYLCQgHAwIGFQgCCQoLBBYCAwECHgECF4AACgkQHhNWiB3Y15FJNRAAuKkCIxJO
</span></span><span style="display:flex;"><span> 3QrcscEPwS0n/gXBPYlAkxNMJOT3Iju8D7aweIjEeEm4YN8wZWNvqD1npkFHcDXl
</span></span><span style="display:flex;"><span> LlNpcsIoQOoyyT4XIJ2bC8z80pxGTUdNd/FcmmJi8QMrg8+xf/cGvA3FdM9vdWOQ
</span></span><span style="display:flex;"><span> lai5m5HyAdz/kvxD5KXw6GUOybzxVSg/MKK+Ugcwl/sHU9FT9zgy5myeNSiChn1J
</span></span><span style="display:flex;"><span> DntBsKh3TWQd3uXKdFS0vaMvDDm3HeSwXBcV0tT8tMuaxOu2gdxv0br+SoFytsN+
</span></span><span style="display:flex;"><span> PSjTTr8Tu6n/EkwMugUmXTqoNRS726nt4fVzbKYIQ9QEz2O8udC5PumHvTIOKcTn
</span></span><span style="display:flex;"><span> ExuMy+M9cZhr5q5YOIIST3A04PtT6oUA5yJPtlQMGpE2642CwebWpXAhz+STWVJ7
</span></span><span style="display:flex;"><span> 9mziN9Spd1TQ7r5wAukvYSRalO67WeONzntyX9KEzL2397ExKvO8FBpSpzms0S2F
</span></span><span style="display:flex;"><span> 34CrZW2MfhrbOb3gh9phUXRLd2anU6k3cTiAMnMmLK+j8y3PDV2AApfhtaHQ7PPB
</span></span><span style="display:flex;"><span> EYCvtsiDj28kpTX2gh9rqhJFG/vQbHBDQQvb8C4eoIYCIwVrZ8GGXZTz+CSLsTax
</span></span><span style="display:flex;"><span> auCjBlLpV1I3n7jAddpHE4nsAA6FkQK63jhQg+maiiIOmdEQa00P+0Re4txOqlJR
</span></span><span style="display:flex;"><span> Kyao3TFRmJY/Z4Qbl3bfDfmzNZ0lZRHGZ+K5Ag0ETJrvhgEQANuySzxnEDcSFToN
</span></span><span style="display:flex;"><span> biGiotoRfCJvKdHjPWLke7Vji+ro4BR151wSjhv7lsVIiGhEmIp/bRO8mY3rwgiG
</span></span><span style="display:flex;"><span> 1RUNI8cqDlzI0PtYJrrhcmi3ppB5y3frkJilFgQijhDHnTTId1d3ntwwzzBrAxh8
</span></span><span style="display:flex;"><span> Bvx7BNbD9cN6ChIUJ6B6ISQpgw7EKnOTfYYc+EA/EppYcNsXKgm77W7/PC5Ss1Q0
</span></span><span style="display:flex;"><span> 1EQ2O9GDQxiF8OEbJANSO4wExAWK5LN4Kuod4vt7hoGzgfKo1woviuephAUxnqqK
</span></span><span style="display:flex;"><span> hK/WG0YB/nPFdGLn+mYWomMTe4ayrCIsHxS70gIt36DUAA1SDCTp8Fb34s9AB6YY
</span></span><span style="display:flex;"><span> EK83g4NW09e/Czoxl3W8Kej1uPwt62MVxjc8HzQ3wPCriXbye5Lc74NARj+N6lor
</span></span><span style="display:flex;"><span> t5CwyPRiy5iBaygZVOw+pBA4kRdi5sGUvbSZ4tTvtCHMcg1zpSHs/P/qSUGsO+wG
</span></span><span style="display:flex;"><span> m9nWCB4i4zsDZ9GlEpneqSVtWgXKEbTzymC/Z0tvORAOvamCkt06nnsbJqNdI7g8
</span></span><span style="display:flex;"><span> 2oCL/rkKCxNG/675kPHJGw/f1GyWuJz/6U1Zv6QFpKzVID9Wj5+pow8uDLxywEWH
</span></span><span style="display:flex;"><span> XmFjMEfg8E0FO4UStCo+qsIUdd6jQHh/VuFsGPQS0lH1FnR+jYljyrxUFcUFlrVz
</span></span><span style="display:flex;"><span> G5YtDrXFILFbEVUkbKrGbsfYUU2BABEBAAGJAh8EGAECAAkFAkya74YCGwwACgkQ
</span></span><span style="display:flex;"><span> HhNWiB3Y15HN0A//QAKmdXv7nuddbe0kWb27779e0HXKpuhj9DyuKU7lXIMqSwtD
</span></span><span style="display:flex;"><span> +/yo4vbb1nGVnPO/+xTF6ecUjnDrEMe/Q2fqHbm3bglwlkii9flvwORjxxBfghdJ
</span></span><span style="display:flex;"><span> ipFuloL3C28VuQgx2kNeYtbvyLP6roZxR80c2+NQTHtkL2Ba2dtiptwsB4vKk+a0
</span></span><span style="display:flex;"><span> vi9g+MjbPknSkoZ6TbZVog7ia0HcbS+QstfXCQUPi1ccKK9oNFVdTTBLamnq4Ts6
</span></span><span style="display:flex;"><span> TAPRmRt7y4ob2dBm4R0Hpb9qIhTsI0+YKL7rtXHX2bFcMgg0OHz/Vn8LGT+euEgc
</span></span><span style="display:flex;"><span> Zi9CQp8C6mrO+mFybBSWhndBra8NPTSY4iLYz/MlHq6vvtFsmeCpO2BpfI5vUSWl
</span></span><span style="display:flex;"><span> tSI7whA5B2wAEJ6oEWHfdxvWSzRDQ+BORk6I4QQZpulQRqjHpeDSiMLCZHXqikdo
</span></span><span style="display:flex;"><span> oYlQr2hin9CBKPECAqNdqVSYjooOJlyEYfRbz/hqsOcfqigqKKJx3vqKSxkta6bi
</span></span><span style="display:flex;"><span> eHjRE+iyP1usPbzY4bLj4gMP/CpDC8+mkNmNluFKFRHmCu+Jzlg+lcYH1tVUqVYe
</span></span><span style="display:flex;"><span> 9wlS6op6YDVVwPWT9vU3sviry81ADb25Dg8TBQz5UCZvF8iHEpTS7KcmWKLW8oNY
</span></span><span style="display:flex;"><span> 2y9kyyQKjvp2s5m59LrAy3gunqEqMS3oxqPj8/NMvWK8mJoL07R52TxDk6k<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">=</span>Ao1Z
</span></span><span style="display:flex;"><span> -----END PGP PUBLIC KEY BLOCK-----
</span></span><span style="display:flex;"><span>EOF
</span></span></code></pre></div><p>Please note a leading space added to each line and for the blank line, it
became &quot; .&quot; to follow Debian configuration file syntax.</p>
<h3 id="setting-up-package-repository">Setting up package repository</h3>
<p>Let&rsquo;s suppose I have this hugo repo checked out at <code>/path/to/osamuaoki-hugo/</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ cd /path/to/osamuaoki-hugo/static
</span></span><span style="display:flex;"><span>$ mkdir -p debian/conf
</span></span></code></pre></div><p>In <code>debian/conf</code> add <code>distributions</code> as:</p>
<pre tabindex="0"><code>Origin: Osamu
Label: Osamu
Codename: sid
Architectures: amd64 source
Components: main
Description: APT repository for Osamu&#39;s infrastructure
SignWith: FDCAD8AB29E281A0E004B510A04CBCEEF08BEFAD
</code></pre><p>And <code>options</code> as:</p>
<pre tabindex="0"><code>verbose
basedir /path/to/osamuaoki-hugo/static/debian/
ask-passphrase
</code></pre><h2 id="adding-personal-binary-package-repository">Adding personal binary package repository</h2>
<p>You create source Debian package source trees in <code>../packages/</code> relative to this web site
source.</p>
<p>You update repository in this web site source by running <code>./repository.sh</code> in this web site source.</p>
<p>Then I can build hugo pages as usual with <code>./update.sh</code>.</p>
<ul>
<li><a href="https://github.com/osamuaoki/osamuaoki-hugo">https://github.com/osamuaoki/osamuaoki-hugo</a> (source repo)</li>
<li><a href="https://github.com/osamuaoki/osamuaoki.github.io">https://github.com/osamuaoki/osamuaoki.github.io</a> (published page repo)</li>
</ul>
<h2 id="personal-packages">Personal packages</h2>
<p>These are my personal packages and their source repo:</p>
<ul>
<li>bss: Btrfs Subvolume Snapshot Utility
<ul>
<li><a href="https://github.com/osamuaoki/bss">https://github.com/osamuaoki/bss</a></li>
</ul>
</li>
<li>osamu-task: Osamu&rsquo;s Task Packages
<ul>
<li><a href="https://github.com/osamuaoki/osamu-task">https://github.com/osamuaoki/osamu-task</a></li>
<li>00-cli, 00-dev, 00-doc, 00-gui, 00-jpn, 00-min, 00-notex, 00-typ</li>
</ul>
</li>
<li>unzip: patched unzip (-O and -I options to support encoding of filenames)
<ul>
<li><a href="https://github.com/osamuaoki/unzip">https://github.com/osamuaoki/unzip</a></li>
<li>provides unzip-i18n</li>
</ul>
</li>
</ul>
<p>Build script is <a href="https://github.com/osamuaoki/osamuaoki-hugo/blob/main/repository.sh">repository.sh</a>.</p>
<ul>
<li>Source is cloned first.</li>
<li>Native packages are build with <code>debuild</code></li>
<li>Non-native packages use gbp-style repo and <code>gbp extract-orig</code> is run before
<code>debuild</code>.</li>
<li><code>repropro</code> publishes build packages to github web pages.</li>
</ul>
<!-- raw HTML omitted -->


<table width="100%">
  <tbody>
  <tr>
  
  <td align="left" width="33%"><a href="/en/2022/07/29/vim-learn-5/">Previous Post</a></td>
  
  <td align="center" width="33%"><a href="/en/">Top</a></td>
  
  <td align="right" width="33%"><a href="/en/2023/02/01/vim-learn-6/">Next Post</a></td>
  
  </tr>
  </tbody>
</table>

</main>

  <footer>
  
  
  <hr/>
  © 2013-2021 <a href="https://github.com/osamuaoki">Osamu Aoki</a>
  
  </footer>
  </body>
</html>

