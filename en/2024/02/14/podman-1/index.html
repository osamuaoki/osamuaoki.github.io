<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Container podman (1) | Goofing Osamu</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/en/">English</a></li>
      
      <li><a href="/jp/">Japanese</a></li>
      
      <li><a href="/index.xml">Subscribe</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Container podman (1)</span></h1>

<h3 class="date">Date:
2024/02/14 (initial publish),
2024/02/15 (last update)
</h3>
<h3 class="source">Source:
en/note-00064.md
</h3>
</div>

<main>


<table width="100%">
  <tbody>
  <tr>
  
  <td align="left" width="33%"><a href="/en/2024/02/02/python-venv/">Previous Post</a></td>
  
  <td align="center" width="33%"><a href="/en/">Top</a></td>
  
  <td align="right" width="33%"><a href="#">***</a></td>
  
  </tr>
  </tbody>
</table>

<h2>TOC</h2>

<nav id="TableOfContents">
  <ul>
    <li><a href="#podman-and-docker-cli"><code>podman</code> and <code>docker</code> CLI</a></li>
    <li><a href="#padman-cli-basics"><code>padman</code> CLI basics</a>
      <ul>
        <li><a href="#run-command-in-container-and-exit">Run command in container and exit</a></li>
        <li><a href="#run-command-in-container-with-redirect-and-exit">Run command in container with redirect and exit</a></li>
        <li><a href="#remove-all-images-1">Remove all images (1)</a></li>
        <li><a href="#run-daemon-in-container-and-access-from-host">Run daemon in container and access from host</a></li>
        <li><a href="#remove-exited-container-images">Remove exited container images</a></li>
        <li><a href="#remove-all-container-images-2">Remove all container images (2)</a></li>
      </ul>
    </li>
  </ul>
</nav>

<p>Here is a series of memos of me trying to use <code>podman</code> on Debian 12 (<code>bookworm</code>).</p>
<h2 id="podman-and-docker-cli"><code>podman</code> and <code>docker</code> CLI</h2>
<p>Basically <code>podman</code> CLI syntax is exactly the same as the <code>docker</code> one except
for the command name itself from user&rsquo;s perspective.  By installing
<code>podman-docker</code> package, you can even use the <code>docker</code> as the command to start
<code>podman</code> command.</p>
<p>Here, you need to make 2 subtle adjustments:</p>
<ul>
<li>Install <code>docker-compose</code> to manage <code>docker</code> containers using the YAML file.</li>
<li>Execute <code>sudo touch /etc/containers/nodocker</code>.</li>
</ul>
<p>The second requirement is because <code>/usr/bin/docker</code> is simple wrapper of <code>podman</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">[</span> -e /etc/containers/nodocker <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>echo <span style="color:#e6db74">&#34;Emulate Docker CLI using podman. Create /etc/containers/nodocker to quiet msg.&#34;</span> &gt;&amp;<span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>exec /usr/bin/podman <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>All manpages provided by the <code>podman-docker</code> package simply redirect requests
to corresponding <code>podman-*</code> manpages.  For example, you can see this background
situation as:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>$ zcat /usr/share/man/man1/docker.1.gz
</span></span><span style="display:flex;"><span>.so man1/podman.1
</span></span></code></pre></div><p>So many tutorial resources for <code>docker</code> can be used for <code>podman</code>.</p>
<h2 id="padman-cli-basics"><code>padman</code> CLI basics</h2>
<h3 id="run-command-in-container-and-exit">Run command in container and exit</h3>
<p>A docker image with its alias <code>debian</code> is used.</p>
<p>Many aliases are defined in <code>/etc/containers/registries.conf.d/shortnames.conf</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span> $ podman run debian cat /etc/os-release
</span></span><span style="display:flex;"><span>PRETTY_NAME=&#34;Debian GNU/Linux 12 (bookworm)&#34;
</span></span><span style="display:flex;"><span>NAME=&#34;Debian GNU/Linux&#34;
</span></span><span style="display:flex;"><span>VERSION_ID=&#34;12&#34;
</span></span><span style="display:flex;"><span>VERSION=&#34;12 (bookworm)&#34;
</span></span><span style="display:flex;"><span>VERSION_CODENAME=bookworm
</span></span><span style="display:flex;"><span>ID=debian
</span></span><span style="display:flex;"><span>HOME_URL=&#34;https://www.debian.org/&#34;
</span></span><span style="display:flex;"><span>SUPPORT_URL=&#34;https://www.debian.org/support&#34;
</span></span><span style="display:flex;"><span>BUG_REPORT_URL=&#34;https://bugs.debian.org/&#34;
</span></span><span style="display:flex;"><span> $ podman ps -a
</span></span><span style="display:flex;"><span>CONTAINER ID  IMAGE                            COMMAND               CREATED        STATUS                    PORTS       NAMES
</span></span><span style="display:flex;"><span>7db8501a5c00  docker.io/library/debian:latest  cat /etc/os-relea...  4 seconds ago  Exited (0) 4 seconds ago              inspiring_dhawan
</span></span></code></pre></div><h3 id="run-command-in-container-with-redirect-and-exit">Run command in container with redirect and exit</h3>
<p>An explicit name <code>bar</code> is set to the generated container.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span> $ echo &#34;Foo&#34; | podman run -i --name=bar debian sed -e &#39;s/o/e/g&#39; &gt; ~/foo
</span></span><span style="display:flex;"><span> $ cat ~/foo
</span></span><span style="display:flex;"><span>Fee
</span></span><span style="display:flex;"><span>$ podman ps -a
</span></span><span style="display:flex;"><span>CONTAINER ID  IMAGE                            COMMAND               CREATED         STATUS                     PORTS       NAMES
</span></span><span style="display:flex;"><span>5d8751ada416  docker.io/library/debian:latest  cat /etc/os-relea...  54 seconds ago  Exited (0) 54 seconds ago              inspiring_dhawan
</span></span><span style="display:flex;"><span>f760a3bbe471  docker.io/library/debian:latest  sed -e s/o/e/g        5 seconds ago   Exited (0) 5 seconds ago               bar
</span></span></code></pre></div><h3 id="remove-all-images-1">Remove all images (1)</h3>
<p>Let&rsquo;s remove all containers.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span> $ podman rm -a
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><h3 id="run-daemon-in-container-and-access-from-host">Run daemon in container and access from host</h3>
<p>An explicit name <code>nginx</code> is set to the generated container.</p>
<p>A docker image with its image reference specified as <code>docker.io/nginx</code> is used.</p>
<p>The host port <code>8080</code> is connected to container port <code>80</code>.</p>
<p>The <code>-d</code> option to run the container in the background.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span> $ podman run -dit --name nginx -p 8080:80 docker.io/nginx
</span></span><span style="display:flex;"><span>6d39687d03a39fac31ccfd1b9d0e0860145a3d22115918ca318544705726adb2
</span></span><span style="display:flex;"><span> $ podman ps -a
</span></span><span style="display:flex;"><span>CONTAINER ID  IMAGE                           COMMAND               CREATED        STATUS            PORTS                 NAMES
</span></span><span style="display:flex;"><span>6d39687d03a3  docker.io/library/nginx:latest  nginx -g daemon o...  4 minutes ago  Up 4 minutes ago  0.0.0.0:8080-&gt;80/tcp  nginx
</span></span></code></pre></div><p>Now, pointing a browser on the host to <code>http://127.0.0.1:8080/</code> displays
&ldquo;Welcome to nginx!&rdquo;.</p>
<h3 id="remove-exited-container-images">Remove exited container images</h3>
<pre tabindex="0"><code> $ docker ps -a
CONTAINER ID  IMAGE                            COMMAND               CREATED         STATUS                     PORTS                 NAMES
6d39687d03a3  docker.io/library/nginx:latest   nginx -g daemon o...  43 minutes ago  Up 43 minutes ago          0.0.0.0:8080-&gt;80/tcp  nginx
419631630b1c  docker.io/library/debian:latest  cat /etc/hostname     7 seconds ago   Exited (0) 6 seconds ago                         zen_jepsen
 $ docker rm $(docker ps -a -q -f status=exited)
419631630b1c
</code></pre><h3 id="remove-all-container-images-2">Remove all container images (2)</h3>
<pre tabindex="0"><code> $ docker rm -a
Error: cannot remove container 6d39687d03a39fac31ccfd1b9d0e0860145a3d22115918ca318544705726adb2 as it is running - running or paused containers cannot be removed without force: container state improper
osamu@goofy:/etc/containers/registries.conf.d 23:44:40
 $ docker rm -a -f
6d39687d03a39fac31ccfd1b9d0e0860145a3d22115918ca318544705726adb2


&lt;!--
 https://docker-curriculum.com/#static-sites
 https://www.server-world.info/en/note?os=Debian_12&amp;p=podman&amp;f=1
 https://www.rosehosting.com/blog/how-to-install-podman-on-debian-12/
 --&gt;

&lt;!-- vim:set sw=4 sts=4 nosi et tw=79 ft=markdown: --&gt;
</code></pre>

<table width="100%">
  <tbody>
  <tr>
  
  <td align="left" width="33%"><a href="/en/2024/02/02/python-venv/">Previous Post</a></td>
  
  <td align="center" width="33%"><a href="/en/">Top</a></td>
  
  <td align="right" width="33%"><a href="#">***</a></td>
  
  </tr>
  </tbody>
</table>

</main>

  <footer>
  
  
  <hr/>
  © 2013-2023 <a href="https://github.com/osamuaoki">Osamu Aoki</a>
  
  </footer>
  </body>
</html>

