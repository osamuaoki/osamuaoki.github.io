<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>QMK (4) -- ホームポジションMT配列 | Goofing Osamu</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/en/">English</a></li>
      
      <li><a href="/jp/">Japanese</a></li>
      
      <li><a href="/index.xml">Subscribe</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">QMK (4) &ndash; ホームポジションMT配列</span></h1>

<h3 class="date">Date:
2022/03/15 (initial publish),
2022/03/19 (last update)
</h3>
</div>

<main>


<table width="100%">
  <tbody>
  <tr>
  
  <td align="left" width="33%"><a href="/jp/2022/03/06/blackpill-3/">Previous Post</a></td>
  
  <td align="center" width="33%"><a href="/jp/">Top</a></td>
  
  <td align="right" width="33%"><a href="#">***</a></td>
  
  </tr>
  </tbody>
</table>

<h2>TOC</h2>

<nav id="TableOfContents">
  <ul>
    <li><a href="#状況">状況</a></li>
    <li><a href="#キーマップ">キーマップ</a></li>
    <li><a href="#pcb参考情報">PCB参考情報</a></li>
  </ul>
</nav>

<h2 id="状況">状況</h2>
<p>QMKを使う<a href="https://github.com/osamuaoki/cg56">cgc56というQMKを利用したキーボード</a>等を使って、色々試して気づいたり考えたことを以下に記します。</p>
<ul>
<li>メンタルストレス無く、フィジカルストレスの小さい指の動きが少ないキーマップが欲しい。
<ul>
<li>親指がカバーするのは、横に並ぶ２キーが望ましい (英語専用なら１つでも可能は可能。動きとしては３つまでは可能だが、PCBが大きくなる)</li>
<li>人差し指は縦の動きで２列カバーする。</li>
<li>他の指は縦１列の動き以外はしない。</li>
<li>「QWERTY」は当分メインのキーマップのベース。</li>
<li>「QWFRTY」はローマ字入力用オプションの検討中キーマップ。</li>
</ul>
</li>
<li>高速打鍵性自体は私の目指す所では無い。</li>
<li>キーのピッチをきっちり確保するにはNC工具での工作が不可欠。
<ul>
<li>NCとしてはPCBが安いし、PCBを注文する際に10cm角に収めると更に安い。</li>
</ul>
</li>
<li>統計結果から、記号では「<code>_</code> 」へのアクセスには要配慮。</li>
<li>14&quot; のノートパソコン(Thinkpad T14 Gen1)に無いキーの優先度は低いと割り切る。
<ul>
<li>CURSORキーは重要なので、アクセス性は重要で、片手での操作性も重要。</li>
<li>TENキーはそれほど使用上重要では無いが、組み込むなら片手での操作性に配慮重要。</li>
<li>QMKのMOUSEキーはそれほど便利では無いので、組み込む際のアクセス性は重要で無い。</li>
</ul>
</li>
</ul>
<p>QMKではタップとホールドで出力キーが違う設定できますが、タップの入力文字の連続入力がカチカチ連打だと大変な気がしていました。</p>
<p>実際には、一度タップ直後の再タップ時にホールドするとタップに対応する文字の長押しになるようで、OS側が連打処理してくれ使い勝手良好です。</p>
<p>あまり複雑なキー動作の多重化は混乱を招き使い勝手が悪くなるのですべきでは無いですが、この辺を上手に使えば悪くない感じです。</p>
<h2 id="キーマップ">キーマップ</h2>
<p>最初にトライしたレイヤー移動とモード変更機能のすべてを親指のキーに任せるアプローチには無理がありました。</p>
<p>そこで30%キーボード系の<a href="https://github.com/qmk/qmk_firmware/tree/master/keyboards/ferris">ferris</a>のキーマップをヒントにし、「基本的に使う部分」を、左<code>3x5_2</code>キーと右<code>3x5_2</code>キーと限定し、親指はレイヤー移動のみにしたキーマップを組むのがフィジカルストレス低減によさそうです。</p>
<pre tabindex="0"><code> │***│ Q │ W │ E │ R │ T │***│***│ Y │ U │ I │ O │ P │***│
 │***│lsA│lcS│laD│lgF│raG│***│***│raH│lgJ│laK│lcL│ls;│***│
 │***│ Z │ X │ C │ V │ B │***│***│ N │ M │ , │ . │ / │***│
 │***│***│***│***│Es3│Sp1│***│***│Sp2│En4│***│***│***│***│
</code></pre><p>ここのポイントは、人差し指〜小指のホームポジションのA行のキーに関して、通常の文字キー入力とモードキー(LSFT, LCTL, LALT, LGUI, RALT)入力を、<code>MT()</code>機能を使い両方ができるようにしています。このおかげで、アクセスのよい自然なポジションでタイプできます。</p>
<ul>
<li>人差し指内側1つ隣: RALT (AltGr)</li>
<li>人差し指: LGUI</li>
<li>中指: LALT</li>
<li>薬指: LCTL</li>
<li>小指: LSFT</li>
</ul>
<p>これで端のキー（特に下の角のキー）を基本使わ無くてもよくなるので、<a href="https://salicylic-acid3.hatenablog.com/entry/key-layout">Alice配列</a>にしなくとも、手首へのストレスが下げられています。</p>
<p>一番下の４つの親指キーは、<code>LT()</code>機能を使って、４つあるTEMPORARY LAYER選択操作に加え、１２までのよくアクセスする非アルファベットキーの入力ができるようにしています。</p>
<p><a href="https://docs.qmk.fm/#/feature_auto_shift?id=retro-shift">Retro Shift</a>を有効にしています。</p>
<p>Thumb（親指）キーで押している際に１時的に有効化する一時レイヤーは実質２つで、横3列の３０物理キーで９０のキーがカバーできます。<code>MT()</code>機能を上手につかえばThumbキーは２つでもレイヤー実現に充分です。ただ、押しやすさと、<code>LT()</code>に加え<code>MT()</code>まで使うのを避けるために、各レイヤーを左右別にして４レイヤーとして打ちやすくレスポンスよくしています。</p>
<ul>
<li>Thumbキーのホームポジションを押すと、ファンクションキー・記号・数字のレイヤーです。</li>
<li>Thumbキーの隣のポジションを押すと、横10個のキーでカバーしきれなかったキーボード端の記号と、固定レーヤー2~4への移動キーのレイヤーです。</li>
<li>Thumbキーを押している側は、ホームポジションのA行のキーはモードキーとなります。</li>
</ul>
<p>上記１時レイヤー以外に、レイヤー移動後固定されるレイヤーが４つあり、カーソル・テンキー・マウスキー・キーボード自体の設定レイヤーとなります。</p>
<p>上記では分かり易い様に、cgc56上の「基本的に使う部分」以外のキーを省略しました。もちろんこれらも使えるようになっています。</p>
<ul>
<li>従来のキーボード両端の小指で操作するキー類や最下行のキー類には、旧来のキーボードと同様の機能を与え、学習障壁を下げるようにします。(小指の操作は嫌ですので、慣れたらなるべく使いません。)</li>
<li>中心部のキー類には、狭いので一時レイヤーに押し込んだキーボード端の記号とか<code>F11</code>や<code>F12</code>、ダイナミックマクロ関連キー、カーソール関連キーのアクセスを改善するために重複配置します。</li>
</ul>
<p>キーマップの詳細の最新の状況は、<a href="https://github.com/osamuaoki/qmk_firmware/blob/osamu1/keyboards/cgc56/keymaps/osamu/keymap.c">私のQMKソース</a>を参照。</p>
<p>ちなみに「基本的に使う部分」だけからなる片側<code>3x5_2</code>キー構成なら、ドーターボードも含めてすべてが片側10cm角に収まりそうです。</p>
<p><img src="/img/split34.png" alt="片側３４キーのスプリットキーボードのイメージ"></p>
<h2 id="pcb参考情報">PCB参考情報</h2>
<p>当分は取り組まないけどPCBを作る際に参考となる情報をまとめました。</p>
<ul>
<li>類似設計例のPCB Data のソース
<ul>
<li><a href="https://github.com/MakotoKurauchi/helix">Helix</a> &ndash; 5x7+2 ortholinear &ndash; RGB-LED, LP or MX (ソケット対応)</li>
<li><a href="https://github.com/climbalima/let-s-Split-v2">let&rsquo;s split v2</a> &ndash; 4x6 ortholinear &ndash; MX (ドーターボード裏付け)</li>
<li><a href="https://github.com/e3w2q/su120-keyboard">SU120</a> &ndash; Expandable keyboard &ndash; RGB-LED, LP or MX （モジュラー）</li>
<li><a href="https://github.com/foostan/crkbd">Corne keyboard and more</a> &ndash; 3x6 +2 column staggered (helix based) (ソケット対応)</li>
<li><a href="https://github.com/raychengy/fifi_split_keeb">Fifi</a> &ndash; 3x5+3 column staggered</li>
<li><a href="https://github.com/pierrechevalier83/ferris">ferris</a> &ndash; 3x5+2 column staggered (on board MCU)</li>
<li><a href="https://github.com/davidphilipbarr/Sweep">Sweep</a> &ndash; 3x5+2 column staggered</li>
</ul>
</li>
<li>参考基礎情報源
<ul>
<li><a href="https://keebfolio.netlify.app/">Keebfol.io PCBs</a> まとめサイト、PCB dataへのリンクあり</li>
<li><a href="https://github.com/mtl/keyboard-pcbs">Keebio Amoeba and more PCBs</a></li>
<li><a href="https://github.com/kiibohd/pcb">PCB design from kiibohd</a> &ndash; input club</li>
<li><a href="https://github.com/colemarkham/keyboard_parts.pretty">Cad data: keyboard_parts.pretty</a></li>
<li><a href="https://www.kailhswitch.com/pcb-socket/">Kailh PCB socket info</a></li>
<li><a href="https://en.gateron.cn">Gateron company</a></li>
<li><a href="https://www.gateron.co/">Gateron switch</a> &ndash; ??? sales ???</li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->


<table width="100%">
  <tbody>
  <tr>
  
  <td align="left" width="33%"><a href="/jp/2022/03/06/blackpill-3/">Previous Post</a></td>
  
  <td align="center" width="33%"><a href="/jp/">Top</a></td>
  
  <td align="right" width="33%"><a href="#">***</a></td>
  
  </tr>
  </tbody>
</table>

</main>

  <footer>
  
  
  <hr/>
  © 2013-2021 <a href="https://github.com/osamuaoki">Osamu Aoki</a>
  
  </footer>
  </body>
</html>

