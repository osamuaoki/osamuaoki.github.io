<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>仮想環境(2) | Goofing Osamu</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/en/">English</a></li>
      
      <li><a href="/jp/">Japanese</a></li>
      
      <li><a href="/index.xml">Subscribe</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">仮想環境(2)</span></h1>

<h3 class="date">Date:
2021/01/08 (initial publish),
2021/01/15 (last update)
</h3>
</div>

<main>


<table width="100%">
  <tbody>
  <tr>
  
  <td align="left" width="33%"><a href="/jp/2020/12/13/virt-01/">Previous Post</a></td>
  
  <td align="center" width="33%"><a href="/jp/">Top</a></td>
  
  <td align="right" width="33%"><a href="#">***</a></td>
  
  </tr>
  </tbody>
</table>

<h2 id="デバグ用の仮想環境作成-lxc">デバグ用の仮想環境作成 (LXC)</h2>
<p>chrootを使ってのデバグ用の仮想環境作成をpbuilder/cowbuilderでと言うのは
少々強引です。とはいえ直接chrootやmountコマンドで仮想環境作成というのも
面倒です。そこで、LXCを使ってのデバグ用の仮想環境作成を試みました。</p>
<pre><code> $ sudo lxc-create -n development-sid -t debian -- -r sid
...
</code></pre><p>もし、ミラーが不調なら、安定そうなUSミラーを使います。</p>
<pre><code> $ sudo lxc-create -n development-sid -t debian -- -r sid \\
   --mirror=http://ftp.us.debian.org
</code></pre><p>意外と簡単です。これで、<code>/var/lib/lxc/development-sid/</code> 以下のディレクトリーに
デバグ用のコンテナ環境のファイルシステムが作成されます。</p>
<p><code>lxc-start</code>でコンテナ環境をシステムとして起動するために、ファイルシステム
に追加の変更をします。</p>
<p>XXX FIXME XXX BELOW</p>
<ul>
<li><code>/etc/fstab</code></li>
</ul>
<pre><code>/dev    /home/root/debian/rootfs/dev none bind 0 0
/dev/pts /home/root/debian/rootfs/dev/pts  none bind 0 0
</code></pre><p>copy from main system</p>
<ul>
<li><code>/etc/passwd</code></li>
<li><code>/etc/group</code></li>
<li><code>/etc/shadow</code></li>
<li><code>/etc/gshadow</code></li>
</ul>
<p>bind mount from main system</p>
<ul>
<li><code>/root</code></li>
<li><code>/home</code></li>
</ul>
<pre><code> $ sudo lxc-start -n development-sid
</code></pre><pre><code> $ lxc-console -n development-sid -t 0
</code></pre><!-- raw HTML omitted -->


<table width="100%">
  <tbody>
  <tr>
  
  <td align="left" width="33%"><a href="/jp/2020/12/13/virt-01/">Previous Post</a></td>
  
  <td align="center" width="33%"><a href="/jp/">Top</a></td>
  
  <td align="right" width="33%"><a href="#">***</a></td>
  
  </tr>
  </tbody>
</table>

</main>

  <footer>
  
  
  <hr/>
  © 2019-2020 <a href="https://github.com/osamuaoki">Osamu Aoki</a>
  
  </footer>
  </body>
</html>

